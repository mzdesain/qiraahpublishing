<!-- Versi revisi dengan semua perubahan yang diminta -->
<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nonton TV</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    :root {
      --bg: #111;
      --text: #fff;
      --item: #1e1e1e;
      --hover: #333;
    }

    body.night {
      --bg: #fff;
      --text: #000;
      --item: #f2f2f2;
      --hover: #ddd;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background: var(--item);
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.4rem;
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .donate-link {
      color: var(--text);
      text-decoration: none;
      font-size: 1.6rem;
      margin-right: 0.5rem;
    }

    .toggle-night {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.2rem;
      cursor: pointer;
    }

    video {
      width: 100%;
      height: auto;
      background: black;
      display: block;
    }

    .fullscreen-btn-container {
      text-align: center;
      margin-top: 0.5rem;
    }

    .fullscreen-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 8px;
      background: #007aff;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }

    .categories {
      display: flex;
      overflow-x: auto;
      padding: 0.5rem;
      background: var(--item);
    }

    .categories button {
      margin-right: 0.5rem;
      padding: 0.4rem 1rem;
      background: #444;
      color: white;
      border: none;
      border-radius: 999px;
      cursor: pointer;
    }

    .categories button.active {
      background-color: #007aff;
    }

    .channel-list {
      padding: 1rem;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 1rem;
    }

    .channel-item {
      background: var(--item);
      padding: 0.8rem;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .channel-item:hover {
      background: var(--hover);
    }

    .channel-name {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 500;
    }

    .favorite-btn {
      background: none;
      border: none;
      color: gold;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <header>
    <div class="header-left">
      <a href="https://saweria.co/namakamu" target="_blank" class="donate-link"><i class="fas fa-donate"></i></a>
      Donasi Saweria
    </div>
    <button class="toggle-night" onclick="toggleNight()"><i class="fas fa-moon"></i></button>
  </header>

  <video id="videoPlayer" controls autoplay></video>
  <iframe id="youtubePlayer" width="100%" height="480" style="display:none;" frameborder="0" allowfullscreen></iframe>


  <div class="fullscreen-btn-container">
    <button class="fullscreen-btn" onclick="rotateFullscreen()">â›¶ Fullscreen</button>
  </div>

  <div class="categories" id="categoryTabs"></div>
  <div class="channel-list" id="channelList"></div>

  <script>
    const iptvChannels = {
      "Religi": [
        { name: "Rodja TV", url: "https://rodjatv.com/rodjatv/live.m3u8" },
        { name: "Al-Iman TV", url: "https://tv.aliman.id/aliman/live.m3u8" },
        { name: "Wesal TV", url: "https://ams.juraganstreaming.com:5443/LiveApp/streams/wesaltv.m3u8" },
        { name: "Al-Wafa Tarim", url: "https://ammedia.siar.us/ammedia/live/playlist.m3u8" },
        { name: "Ashiil TV", url: "https://h1.intechmedia.net/intech/ch2.m3u8" },
        { name: "Bin Baz TV", url: "https://h1.intechmedia.net/intech/ch22.m3u8" },
        { name: "Insan TV", url: "https://h1.intechmedia.net/intech/ch1.m3u8" },
        { name: "Inspira TV", url: "https://inspiratv.siar.us/inspiratv/live/playlist.m3u8" },
        { name: "MQ TV", url: "https://5bf7b725107e5.streamlock.net/mqtv/mqtv/playlist.m3u8" },
        { name: "Surau TV", url: "https://h1.intechmedia.net/intech/ch3.m3u8" },
      ],
      
      "Olahraga": [
        { name: "TVRI Sport", url: "https://ott-balancer.tvri.go.id/live/eds/SportHD/hls/SportHD.m3u8" },
        { name: "beIN SPORTS XTRA", url: "https://apollo.production-public.tubi.io/live/ac-bein.m3u8" }
      ],
      
      "Berita": [
        { name: "Garuda TV", url: "http://stream.garuda.tv/live/garudatv/playlist.m3u8" },
        { name: "Nusantara", url: "https://nusantaratv.siar.us/nusantaratv/live/chunks.m3u8" },
        { name: "RRI Net", url: "https://rrinet.rri.co.id/hls/live.m3u8" },
        { name: "Celebes TV", url: "https://ams.juraganstreaming.com:5443/LiveApp/streams/celebesmedia.m3u8" },
        { name: "BeritaSatu", url: "https://b1world.beritasatumedia.com/Beritasatu/B1World_manifest.m3u8" }
      ],
      
      "Lainnya": [
        { name: "Kesehatan TV", url: "https://5bf7b725107e5.streamlock.net/tvkesehatan/tvkesehatan/playlist.m3u" },
        { name: "Bein Sport", url: "http://ns8.indexforce.com:1935/ann/ann/playlist.m3u8" },
      ],
      
      "YouTube": [
        { name: "Makkah", url: "https://www.youtube.com/embed/baxmdgM5-NM?si=IVHgf3trFu7fXwnB" },
        { name: "SRB Official", url: "https://www.youtube.com/embed/zAM38eXb7DM?si=RAhEh6g0K3GYMTGZ" }
      ]
    };

    const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    const video = document.getElementById("videoPlayer");
    const categoryTabs = document.getElementById("categoryTabs");
    const channelList = document.getElementById("channelList");
    let hls;

    function toggleNight() {
      document.body.classList.toggle("night");
    }

    function playChannel(url) {
  const youtube = document.getElementById("youtubePlayer");

  if (url.includes("youtube.com")) {
    video.style.display = "none";
    youtube.style.display = "block";
    youtube.src = url;
    return;
  }

  // Reset YouTube iframe
  youtube.style.display = "none";
  youtube.src = "";

  video.style.display = "block";
  if (Hls.isSupported()) {
    if (hls) hls.destroy();
    hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
  } else {
    video.src = url;
  }
  video.play();
}

function rotateFullscreen() {
  if (video.requestFullscreen) {
    video.requestFullscreen().then(() => {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock("landscape").catch(() => {
          // Rotasi tidak didukung / ditolak user
        });
      }
    });
  }
}

    function loadCategories() {
      categoryTabs.innerHTML = "";
      Object.keys(iptvChannels).forEach((cat, i) => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.onclick = () => {
          document.querySelectorAll(".categories button").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          loadChannels(cat);
        };
        if (i === 0) btn.classList.add("active");
        categoryTabs.appendChild(btn);
      });
      loadChannels(Object.keys(iptvChannels)[0]);
    }

    function loadChannels(category) {
      channelList.innerHTML = "";
      iptvChannels[category].forEach(channel => {
        const item = document.createElement("div");
        item.className = "channel-item";
        item.onclick = () => playChannel(channel.url);
        const favBtn = document.createElement("button");
        favBtn.innerHTML = '<i class="fas fa-eye"></i>';
        favBtn.className = "favorite-btn";
        favBtn.onclick = e => { e.stopPropagation(); toggleFavorite(channel); };
        const nameRow = document.createElement("div");
        nameRow.className = "channel-name";
        nameRow.textContent = channel.name;
        nameRow.appendChild(favBtn);
        item.appendChild(nameRow);
        channelList.appendChild(item);
      });
    }

    function toggleFavorite(channel) {
      // Optional implementation
    }

    loadCategories();
  </script>
</body>
</html>
